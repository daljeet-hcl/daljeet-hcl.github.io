<!DOCTYPE html>
<html>

<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.13/clipboard.min.js"></script>
  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

  <!-- Latest compiled JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>

<body>

  <h2>Guru Granth Sahib text copy utility</h2>
  <div id="title"> </div>
  <div class="form-group" id="content">
      <label for="page">Pageno:</label>
    <input type="number" class="form-control" id="page">
    <br>
    <button type="button" class="btn" onclick="loadXMLDoc()">Load Page</button>
    <button type="button" class="btn" onclick="copy()">Preview</button>;

    <form id="demo"></form>
  </div>

  <script>
    var resonse;

    var body = $('body');
    var btn = '<button class="btn" id="snipButton" data-clipboard-target="#title">Copy to clipboard</button>';
    var btn2 = '<button class="btn" id="snipButton" data-clipboard-target="#title">Copy to clipboard</button>';
    body.append(btn);
    body.prepend(btn2);
    var clipboard = new Clipboard('#snipButton');

    function copy() {
      document.getElementById("title").innerHTML = '';
      $('input:checkbox').filter(':checked').map(function () {
        var lineNo = $(this).val();
        console.log("lineNo"+lineNo);
        console.log(response.page[lineNo].line.transliteration.devanagari.text);
        console.log(response.page[lineNo].line.translation.english.default);
        document.getElementById("title").innerHTML += '<br/><b>*' + response.page[lineNo].line.transliteration.devanagari.text + '*<b/><br/>';
        document.getElementById("title").innerHTML += response.page[lineNo].line.translation.english.default + '<br/>';
      });

    }

    function loadXMLDoc() {
      var xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
          response = JSON.parse(this.responseText);
          console.log(response.pageno);
          $("#demo").html("<p/>");
          $("#demo").html( $("#demo").html() + "Page No = " + response.pageno);
          $("#demo").html( $("#demo").html() + "<br/>");

          response.page.map((line, index) => {
            $("#demo").html( $("#demo").html()+"<br/> <input type='checkbox' value="+index+" /><b>" + line.line.transliteration.devanagari.text+'</b>');
            $("#demo").html( $("#demo").html()+ "<br/>"+ line.line.translation.english.default+"<br/>");
          });
        }
      };
      xhttp.open("GET", "https://api.gurbaninow.com/v2/ang/" + document.getElementById("page").value, true);
      xhttp.send();
    }
  </script>

</body>

</html>